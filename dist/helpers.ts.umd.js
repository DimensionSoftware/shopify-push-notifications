!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("query-string"),require("node-fetch")):"function"==typeof define&&define.amd?define(["exports","query-string","node-fetch"],t):t(e.shopifyPushNotifications={},e.queryString,e.fetch)}(this,function(e,t,r){r=r&&r.hasOwnProperty("default")?r.default:r,"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var o=require("node-forge");e.request=function(e,n,i,s){try{return Promise.resolve(function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(function(){var a,u,f=(a=o.md.sha256.create(),u=o.random.getBytesSync(8),a.update(u),a.digest().toHex()),c=function(e,r,n){var i=t.parse(n),s=Object.assign({},i),a=Object.keys(s).sort().reduce(function(e,t){return e.push(t+"="+s[t]),e},[]).join(""),u=o.hmac.create();return console.log("sorted params: ",a),u.start("sha256",e),u.update(a),u.digest().toHex()}(n,0,"?path_prefix=/apps/dimensionauth&seed="+f+"&shop="+e);return Promise.resolve(r("https://"+e+"/apps/dimensionauth/api"+i+"?"+t.stringify({seed:f,sig:c}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).then(function(e){return Promise.resolve(e.json())})},function(e){return{success:!1,error:e}}))}catch(e){return Promise.reject(e)}},e.shopifyDomainFrom=function(e){return e.indexOf("myshopify.com")>=0?e:-1===e.indexOf(".")?e+".myshopify.com":e}});
//# sourceMappingURL=helpers.ts.umd.js.map
