var e,r=require("query-string"),t=(e=require("node-fetch"))&&"object"==typeof e&&"default"in e?e.default:e;"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var o=require("node-forge");exports.request=function(e,n,s,i){try{return Promise.resolve(function(e,r){try{var t=e()}catch(e){return r(e)}return t&&t.then?t.then(void 0,r):t}(function(){var a,u,c=(a=o.md.sha256.create(),u=o.random.getBytesSync(8),a.update(u),a.digest().toHex()),y=function(e,t,n){var s=r.parse(n),i=Object.assign({},s),a=Object.keys(i).sort().reduce(function(e,r){return e.push(r+"="+i[r]),e},[]).join(""),u=o.hmac.create();return console.log("sorted params: ",a),u.start("sha256",e),u.update(a),u.digest().toHex()}(n,0,"?path_prefix=/apps/dimensionauth&seed="+c+"&shop="+e);return Promise.resolve(t("https://"+e+"/apps/dimensionauth/api"+s+"?"+r.stringify({seed:c,sig:y}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).then(function(e){return Promise.resolve(e.json())})},function(e){return{success:!1,error:e}}))}catch(e){return Promise.reject(e)}},exports.shopifyDomainFrom=function(e){return e.indexOf("myshopify.com")>=0?e:-1===e.indexOf(".")?e+".myshopify.com":e};
//# sourceMappingURL=helpers.ts.js.map
